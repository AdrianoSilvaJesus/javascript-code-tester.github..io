var linhaAtual,palavraAtual,entradaTexto=document.getElementById("entrada-texto"),cursor=document.getElementsByClassName("cursor")[0],linhas=[];!function(){function a(){linhaAtual=criaSpan("linha"),palavraAtual=criaSpan("palavra"),cursor=criaSpan("cursor"),linhas.push(linhaAtual),entradaTexto.appendChild(linhaAtual),linhaAtual.appendChild(palavraAtual),cursor.innerText="|",linhaAtual.appendChild(cursor),linhaAtual.addClass("line-selected")}function l(a){(palavraAtual=criaSpan("palavra")).textContent=a?" ":"",linhaAtual.appendChild(palavraAtual),linhaAtual.appendChild(cursor)}function e(e,n){var t=palavraAtual.textContent;if(e||n){switch(n){case"enter":return linhaAtual.removeClass("line-selected"),linhaAtual.lastChild.remove(),linhaAtual=criaSpan("linha"),linhas.push(linhaAtual),linhaAtual.addClass("line-selected"),entradaTexto.appendChild(linhaAtual),l(),void contadorLinha("incrementar");case"space":return void l(!0);case"cima":return void moveLinha("cima");case"baixo":return void moveLinha("baixo")}palavraAtual.textContent=t+=e,destacaPalavra(palavraAtual.textContent.trimLeft())}else if(palavraAtual.textContent=t=t.removeCharAtPosition(t.length),destacaPalavra(t),0==t.trim().length){if(palavraAnterior=palavraAtual.previousSibling,linhaAtual.removeChild(palavraAtual),!palavraAnterior)return function(){linhas.pop();var l=linhaAtual.remove().previousSibling;if(!(l instanceof HTMLElement))return a();palavraAtual=(linhaAtual=l).lastChild,contadorLinha("decrementar"),linhaAtual.addClass("line-selected"),linhaAtual.appendChild(cursor)}();palavraAtual=palavraAnterior}}a(),window.onkeypress=function(a){e(String.fromCharCode(a.keyCode))},window.onkeydown=function(a){switch(a.keyCode){case 8:case 46:e();break;case 13:e(null,"enter");break;case 32:e(null,"space");break;case 38:e(null,"cima");break;case 40:e(null,"baixo");break;case 37:e(null,"cima");break;case 39:e(null,"baixo")}}}();